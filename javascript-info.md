# JavaScript 进阶

## 基础

### 数据类型

JavaScript 是一门动态类型的编程语言，意味着虽然有数据类型，但是变量却不与数据类型绑定。

在 JavaScript 中有 **7** 种基本数据类型：`number`、`string`、`boolean`、`null`、`undefined`、`object` 和 `symbol`。

#### `number` 类型

`number` 类型不仅包括整数和浮点数，而且还包括了一些特殊的数字：`Infinity`、`-Infinity` 和 `NaN`。

- `Infinity` 表示数学上的无穷大，它比任何数字都大
- `-Infinity` 表示数学上的无穷小，它比任何数字都小
- `NaN` 表示数字的计算错误，由不正确的数学运算产生，对于 `NaN` 的数学运算的返回值都是 `NaN`。

> 注意：JavaScript 中所有的数学运算都是安全的，比如说除以 0，把非数字的字符串当做数字使用等，都不会产生致命错误，最多也就是得到 `NaN` 这个答案。

#### `string` 类型

JavaScript 中所有的字符串都需要使用引号包围。在 JavaScript 中有 3 种引号：

- 双引号：` " `
- 单引号：` ' `
- 反引号：`` ` ``

单引号和双引号都是简单的引号，它们在 JavaScript 种并没有明显区别。反引号是增强功能版的引号，它允许我们在字符串中通过 `${...}` 内嵌变量和表达式。

#### `boolean` 类型

布尔类型只有两个值：`true` 和 `false`。

#### `null` 类型

值 `null` 是一种特殊的类型，这种类型中只包含 `null` 类型，表示值的空缺。

#### `undefined` 类型

值 `undefined` 和 `null` 类似，唯一属于 `undefined` 类型，表示未被赋值。

#### 对象类型

上面的类型都是原始类型，因为它们的值非常简单。相反的，对象被用来存储数据的集合或者是更加复杂的实体。

#### `Symbol` 类型

`Symbol` 类型用于为对象创建独一无二的标志符。

#### `typeof` 操作符

`typeof` 操作符返回操作数的类型字符串，这在数据检查或者区别对待不同类型的数据时非常有用。

这个操作符支持两种语法：

1. 以操作符形式使用：`typeof x`
1. 类函数式调用：`typeof(x)`

```js
typeof undefined // 'undefined'
typeof 0 // 'number'
typeof true // 'boolean'
typeof 'foo' // 'string'
typeof Symbol('id') // 'symbol'
typeof Math // 'object'，Math 是提供数学运算的内置对象
typeof null // 'object'，这是语言本身的错误
typeof alert // 'function'，alert 是语言内置的方法，其属于对象类型，但 typeof 中对其进行了区别对待
```

### 类型转换

大多数情况下，操作符和函数会自动将一个值转换成正确的类型，这就是**类型转换**。例如：`alert` 函数会自动将任何值转换为字符串以显示。数学运算符会将值转换为数字。但是在有些情况下，我们也希望能够显式地进行类型转换。下面介绍了原始值之间的转换。

#### 字符串转换

字符串转换发生在我们需要字符串形式的值的时候，可以通过调用 `String(value)` 方法来将值转换为字符串。

#### 数字转换

数字转换发生在*数学方法*和*表达式*中，可以通过调用 `Number(value)` 方法来将值转换为数字。转换规则如下：

| 值 | 转换之后的值 | 
| :-- | :-- |
| undefined | NaN |
| null | 0 |
| true/false | 1/0 |
| string | 移除开始和结尾的空白字符，如果留下来的字符串是空字符串，则转换为 0，否则，从字符串起始解析，如果出现解析失败，则返回 NaN |

> 注意：如果数字运算符 `+` 的一侧是一个字符串，那么将执行字符串拼接，将不是字符串的操作数转换为字符串。其他情况下，都将转换为数字。

#### 布尔值转换

布尔值转换是最简单的一个，其转换发生在逻辑操作中，可以通过调用 `Boolean(value)` 方法来将值转换为布尔值。转换规则是：

- 如果值表示空，比如 `0`、`''`、`null`、`undefined`、`NaN` 以及 `false` 等，都将转换为 `false`。
- 否则，转换为 `true`。

> 注意：`'0'` 被处理为 `true`，JavaScript 中非空字符串都被处理为 `true`。

### 运算符

#### 运算符的分类

- 操作数：运算符作用的对象，也被称为参数
- 一元运算符：只有一个操作数的运算符，例如取负数的 `-`
- 二元运算符：有两个操作数的运算符

#### 字符串拼接

当运算符 `+` 作用于字符串时，它的作用将是合并字符串。

#### 数字转换

当运算符 `+` 作为一元运算符使用时，如果操作数是数字，则没有任何变化。但是，如果操作数不是数字，则将把它转换为数字，作用与 `Number(value)` 一致。

#### 操作符优先级

当一个表达式中有超过一个运算符时，执行顺序将由操作符的优先级决定。一般的，一元运算符的优先级比对应的二元运算符的优先级要高。

#### 赋值

注意到赋值符号 `=` 也是一个运算符，这个运算符具有很低的优先级。此外，`=` 运算符支持链式赋值。

> 注意：赋值运算符返回一个值，这个值就是运算的结果。

#### 求余运算符

求余运算符 `%` 与百分比没有任何关系，`a % b` 的值就是 `a` 除以 `b` 的余数。

#### 求指运算符

求指运算符 `**` 是语言规范中新增加的运算符，`a ** b` 的值就是 `a` 自身乘以自身 `b` 次的值。

#### 自增/自减

自增和自减运算符是最长用到的数字运算符，自增将值增加 1，自减将值减少 1。自增和自减运算符可以作为前置或者后置使用，其区别在于前置时返回操作后的值，后置返回操作后的值。如果返回值没有用到，那么前置和后置的形式作用是一样的。

#### 位运算符

位运算符将参数作为 32 位二进制数对待，对其二进制形式进行处理。操作符有：AND(`&`)、OR(`|`)、XOR(`^`)、NOT(`~`)`、LEFT SHIFT(`<<`)`、RIGHT SHIFT(`>>`)、ZERO-FILL RIGHT SHIFT(`>>>`)。

另外，对于算术运算符以及位运算符都支持“修改和赋值”运算符，比如：`/=`、`-=`。

#### 逗号

逗号运算符（`,`）是最不常用的运算符，一般都是被用来简化代码，这种情况下，返回值为最后一个的返回值。例如：

```javascript
// three operations in one line
for (a = 1, b = 3, c = a * b; a < 10; a++) {
  // code goes here
}
```

> 注意：逗号运算符具有非常低的优先级，甚至比赋值运算符还低。

### 比较

#### 结果是布尔值

像其他的运算符一样，比较也会返回一个值，这个值一定是布尔类型。

#### 字符串比较

比较字符串之间谁更“大”，这指的是字典顺序。换句话说，字符串的比较是一个字符一个字符比较的。

比较两个字符串的算法十分简单：

1. 比较两个字符串的第一个字符
1. 如果第一个比第二个要大（小），那么第一个字符串比第二个字符串要大（小），比较规则为字符的 Unicode 编码值大小
1. 如果两个字符是相同的，那么比较下一个字符
1. 重复上面的操作直到达到任何字符串的结尾
1. 如果两个字符串同时结束，那它们是相等的，否则较长的更大

#### 字符串、布尔、数字类型之间的比较

这些类型之间进行比较时，会将操作数先转换为数字。这将导致一些有趣的现象：

```javascript
let a = 0
alert(Boolean(a)) // false
let b = '0'
alert(Boolean(b)) // true
alert(a == b) // true！
```

#### 严格等于

上面的不严格等于会出现问题，比如它无法辨别 `0` 和 `false`。这是因为在不严格等于比较时，不同类型都将被转换为数字。

所以，针对上面的问题，引入严格等于以在不转换类型的前提下检查相等性。

#### `null` 和 `undefined` 的比较

- 在严格等于的情况下，`null` 和 `undefined` 是不同的，因为它们自身的类型就不同。
- 在不严格等于的情况下，`null` 和 `undefined` 是相同的，而且它们都不和其他任何值相等。
- 在数学比较运算符（`>`、`<`、`>=`、`<=`）下，`null` 被转换成 `0`，而 `undefined` 被转换为 `NaN`。这将导致一些有趣的事情。

```javascript
alert(null > 0) // false
alert(null == 0) // false
alert(null >= 0) // true
```

#### 不可比较的 `undefined`

值 `undefined` 不该参与比较中，因为它与其他值的比较经常是 `false`。

#### 规避原则

千万不要对可能是 `null` 或 `undefined` 的变量使用 `>=`、`<=`、`>`、`<` 比较，如果可能要这种值，一定要单独处理。

### 交互：`alert`、`prompt`、`confirm`

既然以浏览器作为基本环境，至少应该知道浏览器提供的交互方法：`alert`、`prompt` 和 `confirm`。

#### `alert`

语法：```alert(message)```

这将显示包含一条消息的模态框，并中断脚本的执行和交互行为直到用户点击确认，返回值为 `undefined`。

#### `prompt`

语法：```result = prompt(title[, default])```

这将显示一个包含标题和输入框的模态框，`title` 为模态框标题，`default` 为输入框的默认值。返回值为输入框的值（字符串形式），取消时返回 `null`。

#### `confirm`

语法：```result = confirm(question)```

这将显示一个包含问题的模态框，`question` 为显示的问题，点击“确定”返回值为 `true`，否则为 `false`。

### 逻辑运算符

JavaScript 中的逻辑运算符有三种：`||`（OR）、`&&`（AND）、`！`（NOT）。优先级方面 `!` &gt; `&&` &gt; `||`。且对于 `||` 和 `&&` 都短路，及尽可能早地结束判断并不处理后面的判断条件。

### `switch` 表达式

`switch` 表达式可以用来替换多个 `if`。一个 `switch` 表达式包含一个或多个 `case` 块以及可选的 `default` 块。

- `switch` 使用严格等于
- `switch` 中 `case` 的执行不会中断，会继续执行下个 `case` 块，除非使用 `break` 
- 当没有匹配成功时，执行 `default` 块中的代码
- `case` 块允许分组共享代码

### 函数

函数是程序中主要的组成块，它们允许执行同样的代码而不重复书写代码，JavaScript 中的函数功能尤其强大。

函数可以访问外层变量，但是方法内的本地变量只能在方法内访问，相同名称的内部变量会在内部覆盖外部变量。

#### 函数默认值

如果某个函数参数没有提供，那么访问这个值就会得到 `undefined`。以前对函数设置默认值的方案通常是：

```javascript
function showMessage(from, text) {
  text = text || 'no text given'
  alert(`${from}: ${text}`)
}
```

现在的做法通常是：

```javascript
function showMessage(from, text='no text given') {
  alert(`${from}: ${text}`)
}
```

#### 函数返回值

函数可以返回一个值作为结果，语法是使用 `return` 关键字，函数执行到 `return` 时，将会返回一个值作为结果，并结束当前函数的执行。另外，如果没有特殊声明 `return`，函数默认返回 `undefined`。

#### 函数命名

函数通常表示动作，所以它们的名字通常会是动词。函数名应该准确、简明，而且一个函数应该只做一件事。

### JavaScript 指令

#### 严格模式

为了激活现代 JavaScript 的所有特性，需要在脚本首部或是函数首部添加指令 `use strict`。

#### 调试

可以通过在代码中添加 `debugger` 以停止当前代码的执行。









 